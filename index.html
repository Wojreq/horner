<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Schemat Hornera</title>
  <style>
    body { 
      font-family: "Segoe UI", Roboto, Arial, sans-serif; 
      padding: 20px; 
      background-image: url('https://iili.io/3MKc919.jpg');
      background-size: cover;
      background-attachment: fixed;
      color: white;
    }

    input, button, td {
      text-shadow: 1px 1px 2px black;
    }

    p, h2, #schemat {
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
    }

    input { 
      width: 60px; 
      text-align: center; 
      margin: 5px; 
      padding: 5px;
      border: 2px solid #4b4b4b;
      background-color: #444;
      color: white;
      font-size: 14px;
    }

    table { 
      border-collapse: collapse; 
      margin-top: 20px; 
      width: 100%;
    }

    td { 
      width: 80px; 
      height: 40px; 
      text-align: center; 
      border: 1px solid #4b4b4b; 
      font-size: 14px;
      color: white;
    }

    .green { background-color: #3b6e46; }
    .cyan { background-color: #1a3d36; }
    .gray { background-color: #616161; }
    .blue { background-color: #3b5998; color: white; }

    button {
      background-color: #4b4b4b;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      font-size: 16px;
      width: 100%;
      margin-top: 10px;
    }

    button:hover {
      background-color: #6a6a6a;
    }

    h2 {
      color: #d3d3d3;
      text-align: center;
      text-shadow: 1px 1px 3px #000;
    }

    @media (max-width: 600px) {
      input { width: 50px; font-size: 12px; }
      table td { width: 60px; font-size: 12px; }
      button { padding: 8px; font-size: 14px; }
      h2 { font-size: 18px; }
    }

    @media (max-width: 400px) {
      input { width: 45px; font-size: 11px; }
      table td { width: 50px; font-size: 11px; }
      button { padding: 6px; font-size: 13px; }
      h2 { font-size: 16px; }
    }
  </style>
</head>
<body>

<h2>Schemat Hornera</h2>

<p>
  Stopie≈Ñ wielomianu N = 
  <input type="number" id="degN" value="4" min="1" onchange="generujPola()">
</p>

<p id="polaWielomianu"></p>

<p>Dziel przez (x + <input id="dzielnik" value="-1">)</p>

<button onclick="oblicz()">Obliczenia</button>

<div id="schemat"></div>

<script>
function generujPola() {
  const N = parseInt(document.getElementById("degN").value);
  let html = '(';
  for (let i = 0; i <= N; i++) {
    const potega = N - i;
    html += `<input id="a${i}" placeholder="np. 1/2" value="0">`;
    if (potega > 1) html += ` x<sup>${potega}</sup> + `;
    else if (potega === 1) html += ` x + `;
  }
  html += ')';
  document.getElementById("polaWielomianu").innerHTML = html;
}

function parseFraction(value) {
  if (value.includes("/")) {
    const parts = value.split("/").map(part => parseFloat(part.trim()));
    if (parts.length === 2) {
      return parts[0] / parts[1];
    }
  }
  return parseFloat(value);
}

function formatCoeff(num) {
  if (Number.isInteger(num)) return num.toString();
  return Number(num.toFixed(4)).toString();
}

function oblicz() {
  const N = parseInt(document.getElementById("degN").value);
  const a = parseFloat(document.getElementById("dzielnik").value);
  const x = -a;

  let coeffs = [];
  for (let i = 0; i <= N; i++) {
    const inputValue = document.getElementById("a" + i).value;
    coeffs.push(parseFraction(inputValue));
  }

  let wynik = [];
  let mnozenia = [];

  wynik[0] = coeffs[0];
  for (let i = 1; i <= N; i++) {
    mnozenia[i] = wynik[i - 1] * x;
    wynik[i] = mnozenia[i] + coeffs[i];
  }

  let html = '<p><strong>Schemat Hornera:</strong></p><table>';
  html += '<tr><td class="cyan"></td>';
  for (let i = 0; i <= N; i++) {
    html += `<td class="green">${coeffs[i]}</td>`;
  }
  html += '</tr>';

  html += '<tr><td class="cyan">1</td><td class="gray"></td>';
  for (let i = 1; i <= N; i++) {
    html += `<td class="gray">${formatCoeff(mnozenia[i])}</td>`;
  }
  html += '</tr>';

  html += '<tr><td class="cyan"></td>';
  for (let i = 0; i < N; i++) {
    html += `<td class="gray">${formatCoeff(wynik[i])}</td>`;
  }
  html += `<td class="blue">${formatCoeff(wynik[N])}</td>`;
  html += '</tr></table>';

  const reszta = wynik[N];
  const wspolczynniki = wynik
    .slice(0, N)
    .map((c, i) => {
      const potega = N - 1 - i;
      if (Math.abs(c) < 1e-10) return '';
      let znak = c > 0 ? '+' : '-';
      let absC = Math.abs(c);
      let liczba = formatCoeff(absC);
      if (potega === 0) return `${znak}${liczba}`;
      if (potega === 1) return `${znak}${liczba}x`;
      return `${znak}${liczba}x<sup>${potega}</sup>`;
    })
    .filter(el => el !== '')
    .join(" ")
    .replace(/^\+/, '')
    .replace(/\+ -/g, '- ');

  html += `<p><strong>Wynik:</strong><br>${wspolczynniki || '0'}</p>`;
  if (Math.abs(reszta) > 1e-10) {
    html += `<p><strong>Reszta:</strong> ${formatCoeff(reszta)}</p>`;
  }

  document.getElementById("schemat").innerHTML = html;
}

generujPola();
</script>

</body>
</html>
